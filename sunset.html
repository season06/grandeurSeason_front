<!DOCTYPE html>
<html>

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <!-- Animate.css -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css" rel="stylesheet"/>
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <!-- import css -->
    <link rel="stylesheet" type="text/css" href="./css/sunset.css">
    <!-- 字體 -->
    <link href="https://fonts.googleapis.com/css2?family=Mogra&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Long+Cang&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/earlyaccess/cwtexfangsong.css" rel="stylesheet">
    
    <title>Sunset ｜ Season</title>
</head>

<body>
    <div id="desktop">
        <div class="head_background">
            <div id='desktop_area'>
                <div id="up" class="animated fadeInDown">
                    <div id="photo_symbol">
                        <img src="./img/symbol.png" width="300" height="100">
                    </div>
                    <div>
                        <p class="head_word">
                            Life is short, world is wide<br>
                            The sooner you start exploring it, the better.<br>
                        </p>
                    </div>
                </div>
                <div id="down">
                    <a href="#menu"><img src="./img/arrow.png" width="50"></a>
                </div>
            </div>
        </div>
    </div>

    <div id="menu">
        <div id="logo">
            <a href="./home.html"><img src="./img/logo.png", width="100"></a>
        </div>
        <div id="menu_category" class="menu_box">
            <div class="category_">
                <div class="category_title">About</div>
            </div>
            <div class="category_">
                <div class="category_title">Travel</div>
                <div class="category_text">
                    <div>
                        <ul style="display: none;">
                            <li><a href="/blog/category/1563617">Taiwan</a></li>
                            <li><a href="/blog/category/1566209">America</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="category_">
                <div class="category_title">Tag</div>
                <div class="category_text">
                    <div>
                        <ul style="display: none;">
                            <li><a href="./sunset.html">Sunset</a></li>
                            <li><a href="./tree.html">Tree</a></li>
                            <li><a href="./road.html">Road</a></li>
                            <li><a href="./mountain.html">Mountain</a></li>
                            <li><a href="./waterfall.html">Waterfall</a></li>
                            <li><a href="./sky.html">Sky</a></li>
                            <li><a href="./sky.html">Sea</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="title">
        <h1 id="fix" class="animated infinite pulse badge badge-pill badge-info"></h1>
    </div>
        
    <div id="photo">
        <div id="photo_area">
            <div class="photo_box">
                <img class="lazyload" src="./img/tag_photograph.jpg">
                <span id="location" class="animated fadeInDown badge badge-pill badge-dark">太平山國家公園</span>
                <img onclick="fav(this)" alt='0' src='./img/favorite_icon.png' id="favorite" class="animated fadeInLeft">
                <img onclick="del(this)" alt='0' src='./img/delete_icon.png' id="delete" class="animated fadeInRight">
            </div>
        </div>
        <div id="end"></div>
    </div>

    <div id="footer">
        <div class="footer_background">
            <div class="footer_word">
                    <div class="footer_title">Season</div><br>
                    <small>engineer | photographer</small><br>
                    <img src="./img/github_icon.png" width="20px"> GITHUB | 
                    <img src="./img/ig_icon.png" width="20px"> INSTAGRAM | 
                    <img src="./img/fb_icon.png" width="20px"> FACEBOOK
            </div>
        </div>
    </div>
    <!-- canvas -->
    <script type="text/javascript" color="0,0,255" pointColor="0,0,255" opacity='0.7' zIndex="-2" count="200"
        src="./canvas/dist/canvas-nest.js"></script>
    <script type="text/javascript" src="./canvas/dist/canvas-nest.umd.js"></script>
    <script type="text/javascript" src="./js/canvas.js"></script>
    <!-- 下拉置頂 -->
    <script type="text/javascript" src="./js/menu.js"></script>
    <!-- 點擊放大 -->
    <!-- <script type="text/javascript" src="./js/bigImg.js"></script> -->
    <!-- api串接 -->
    <script>
        $.ajax({
            type: "GET",
            url: "http://127.0.0.1:8000/findImage_by_tag?tag=sunset",
            dataType: "json",
            success: function(response) {
                lazyload(response);
            }
        });
        $.ajax({
            type: "GET",
            url: "http://127.0.0.1:8000/findImageNum?tag=sunset",
            dataType: "json",
            success: function(response) {
                var text = "Sunset (" + response.image_num + ")";
                document.getElementById("fix").textContent=text;
            }
        });
    </script>
    <!-- lazy load-->
    <script type="text/javascript" src="./js/lazyload.js"></script>
    
    <!-- icon click -->
    <script type="text/javascript">
        function fav(obj) {
            var index = obj.getAttribute("alt");
            var param = $.param({"id": index});
            $.ajax({
                type: "GET",
                url: "http://127.0.0.1:8000/addFavorite?" + param,
                dataType: "json",
                success: function(response) {
                    img_src = './img/favorite_icon.png';
                    if(response.Favorite==1) {
                        img_src = './img/favorite_icon_red.png';
                    }
                    obj.src = img_src;
                }
            });
        }
        function del(obj) {
            var index = obj.getAttribute("alt");
            var param = $.param({"id": index});
            $.ajax({
                type: "GET",
                url: "http://127.0.0.1:8000/deleteImage?" + param,
                dataType: "json",
                success: function(response) {
                    window.location.reload();
                }
            });
        }
    </script>

    <!-- 下拉加載圖片 -->
    <!-- <script>
        $(window).on('scroll',search)
        function search(){
            if (checkScrollSlide){
                // 遍歷後臺的資料
                $.each(dataInt,function(key,value){
                    // 直接用jQuery方法就可以建立元素，新增類名，新增到父元素後面，方法可以通過.迭代 
                    var oBox = $('<div>').addClass('photo_box').appendTo('#photo_area');
                    var oImg = $('<img>').attr('src','./img/sunset/'+ $(value).attr('src')).appendTo($(oBox));
                })
                waterfall();
                dataInt = [];
            }
        }
        function waterfall(){
            // > 取mian元素的第一個子元素
            var $boxs = $('#photo_area>div');
            // 列寬width（）只能獲得圖片寬度，outerWidth（）能獲得邊界寬度
            var w = $boxs.eq(0).outerWidth();
            var cols = Math.floor($(window).width()/w);
            $('#photo_area').width(cols*w).css('margin', '0 auto');
            var hArr=[];
            // jquery的遍歷方法
            $boxs.each(function(index,value){
                //console.log(value); 列印的是dom物件，
                var h=$boxs.eq(index).outerHeight();
                if (index<cols){
                    // 獲取第一行的高度
                    hArr[index]=h;
                }
                else{
                    // 獲取最矮的圖片的索引
                    var minH = Math.min.apply(null,hArr);
                    // inArray函式能獲取指定數值的索引
                    var minHIndex = $.inArray(minH,hArr);
                    // value是dom物件，不能直接用jQuery方法直接操作，要轉換為jQuery物件
                    $(value).css({
                        'position':'absolute',
                        'top':minH +'px',
                        'left':minHIndex*w +'px',
                    })
                    // 在else迴圈中  改變的是加上下一行元素後的高度
                    hArr[minHIndex] += $boxs.eq(index).outerHeight();
                }				
            })
        }

        function checkScrollSlide(){
            // 獲取最後一個圖片
            var $lastBox = $('#photo_area>div').last();
            // 最後一個圖片距離父元素的高度和自身一半的高度
            var lastBoxDis = $lastBox.offset().height+Math.floor($lastBox.outerHeight());
            var scrollTop = $(window).scrollTop();
            var documentH = $(window).height();
            return(lastBoxDis<scrollTop+documentH)?true:false;
        }
    </script> -->

    
</body>

</html>